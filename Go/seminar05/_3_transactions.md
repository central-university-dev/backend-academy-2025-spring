# Работа с транзакциями

Что такое транзакции и ACID - не тема семинара.

https://habr.com/ru/companies/alfa/articles/812417/
https://habr.com/ru/articles/555920/

## Есть несколько принципиальных вариантов работы с транзакциями в приложении с многослойной архитектурой

1. Работать с транзакциями принципиально только на уровне репозитория

  - всё изолировано - это плюс
  - удобно, потому что не надо ничего изобретать - это плюс
  - придётся для любого набора действий писать метод репозитория, который будет оборачивать всё в транзакцию (см. pgx)
  - полностью теряется гибкость

2. Работать с транзакциями из слоя бизнес логики (application)

  - может протечь абстракция хранения данных (спорно)
  - можно в репозитории реализовать гранулярные методы выборки/обновления/вставки/удаления и пользоваться ими везде

## Варианты работы с транзакцией из application

1. Транзакции в слое логики (пример в 1_tx_in_app)
2. Транзакции внутри репозитория (пример в 2_tx_in_repo)
3. Транзакции переданные в контексте (пример в 3_in_ctx)
4. Использовать библиотеку менеджера транзакций (например https://github.com/avito-tech/go-transaction-manager/)