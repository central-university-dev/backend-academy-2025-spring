# Выделенный кэш

Такой подход к кэшированию состоит в том, что один или несколько экземпляров кэша разворачиваются отдельно от экземпляров приложения.

Преимущества:

* можно масштабировать кэш как вертикально (меняя размер экземпляров), так и горизонтально (меняя количество экземпляров), независимо от масштабирования приложения
* данные остаются в кэше после завершения экземпляра приложения
* один экземпляр кэша может обслуживать несколько экземпляров приложения

Недостатки:

* увеличивается задержка (latency) доступа к данным в кэше — приложению нужно выполнить дополнительный сетевой запрос
* увеличивается радиус взрыва: отказ одного экземпляра кэша может оказать влияние на несколько экземпляров приложения
* появляется дополнительная точка отказа

Чаще всего в качестве выделенного кэша используется `redis` и его замены: `valkey` и `keydb`.

## Standalone

[Диаграмма](../diagrams/03/standalone.c4)

[Пример кода из семинара 4](../../seminar04/code/part3)

Standalone redis — одно из самых простых решений для экземпляра кэша. Его просто поднять даже на локальной машине.

Это решение не обеспечивает высокую доступность: надо поднимть новый экземпляр (ноду), если упадёт старый.

Горизонтальное масштабирование в standalone тоже не предусмотрено. Впрочем, можно поднять несколько standalone нод, но маршрутизацию между ними необходимо полностью определять на стороне клиента.

Можно применять вертикальное масштабирование, увеличивая объём ресурсов данной ноды. 

Если используется redis или valkey, то нет смысла выделять больше 2 ядер CPU на ноду. В отличие от них, keydb способен утилизировать и больше ядер.

Объём памяти, который можно выделить на одну ноду, ограничен реальной инфраструктурой, но на практике для одной ноды выделяется до 16-32 ГБ RAM. 

## Sentinel

[Диаграмма](../diagrams/03/sentinel.c4)

[helm chart](https://github.com/bitnami/charts/tree/main/bitnami/redis) для разворачивания в kind.

## Cluster

[Диаграмма](../diagrams/03/cluster.c4)

[helm chart](https://github.com/bitnami/charts/tree/main/bitnami/redis-cluster) для разворачивания в kind.
